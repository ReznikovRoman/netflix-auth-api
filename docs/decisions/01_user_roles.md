# Роли пользователя

-----


## Контекст

-----
- У пользователя есть список ролей (`viewer`, `subscriber`, и т.п.).
- Наличие некоторых ролей открывает пользователю доступ к расширенному функционалу платформы.
- Для проверки наличия роли уже есть готовое АПИ.
- В сервисах часто проверяются роли, поэтому хотелось бы ускорить эту проверку.


## Решение

-----
Роли пользователя сохраняются в JWT токене в качестве `additional claims`.

Любой клиент может декодировать токен с помощью секретного ключа и получить список ролей.


## Последствия

-----
Если роли пользователя обновляются (например, он покупает подписку и получает роль `subscriber`),
а клиент продолжает использовать старый access токен, то мы неверно будем определять
роли пользователя (потому что в старом access токене они не изменились).

Мы предполагаем, что клиенты сами будут отвечать за корректное обновление токенов
(например, получение нового access токена после изменения ролей по refresh токену).
А сами сервисы, которым нужна проверка ролей, не будут ответственны за это.
